admin-authorizer:
  handler: src/handlers/authorizers/admin-authorizer.handler

post-admin-login:
  handler: src/handlers/admin/post-admin-login.handler
  timeout: 30
  events:
    - http:
        path: /admin/login
        method: post
        cors: ${self:custom.cors}

post-admin-register:
  handler: src/handlers/admin/post-admin-register.handler
  timeout: 30
  events:
    - http:
        path: /admin/register
        method: post
        cors: true

post-admin-confirmation-code:
  handler: src/handlers/admin/post-admin-confirmation-code.handler
  timeout: 30
  events:
    - http:
        path: /admin/confirmation-code
        method: post
        cors: ${self:custom.cors}

post-admin-forgot-password:
  handler: src/handlers/admin/post-admin-forgot-password.handler
  timeout: 30
  events:
    - http:
        path: /admin/forgot-password
        method: post
        cors: ${self:custom.cors}

post-admin-reset-password:
  handler: src/handlers/admin/post-admin-reset-password.handler
  timeout: 30
  events:
    - http:
        path: /admin/reset-password
        method: post
        cors: ${self:custom.cors}

post-admin-confirm-password:
  handler: src/handlers/admin/post-admin-confirm-password.handler
  timeout: 30
  events:
    - http:
        path: /admin/confirm-password
        method: post
        cors: ${self:custom.cors}
        authorizer:
          name: admin-authorizer
          type: TOKEN

get-admin-refresh:
  handler: src/handlers/admin/get-admin-refresh.handler
  timeout: 30
  events:
    - http:
        path: /admin/refresh
        method: get
        cors: ${self:custom.cors}

get-admin-session:
  handler: src/handlers/admin/get-admin-session.handler
  timeout: 30
  events:
    - ${self:custom.keepAlive}
    - http:
        path: /admin/session
        method: get
        cors: ${self:custom.cors}
        authorizer:
          name: admin-authorizer
          type: TOKEN

post-admin-mfa-sms-enable:
  handler: src/handlers/admin/mfa/post-admin-mfa-sms-enable.handler
  timeout: 30
  events:
    - http:
        path: /admin/mfa/sms-enable
        method: post
        cors: ${self:custom.cors}
        authorizer:
          name: admin-authorizer
          type: TOKEN

post-admin-mfa-totp-enable:
  handler: src/handlers/admin/mfa/post-admin-mfa-totp-enable.handler
  timeout: 30
  events:
    - http:
        path: /admin/mfa/totp-enable
        method: post
        cors: ${self:custom.cors}
        authorizer:
          name: admin-authorizer
          type: TOKEN

post-admin-mfa-totp-associate:
  handler: src/handlers/admin/mfa/post-admin-mfa-totp-associate.handler
  timeout: 30
  events:
    - http:
        path: /admin/mfa/totp-associate
        method: post
        cors: ${self:custom.cors}
        authorizer:
          name: admin-authorizer
          type: TOKEN

post-admin-mfa-totp-verify:
  handler: src/handlers/admin/mfa/post-admin-mfa-totp-verify.handler
  timeout: 30
  events:
    - http:
        path: /admin/mfa/totp-verify
        method: post
        cors: ${self:custom.cors}
        authorizer:
          name: admin-authorizer
          type: TOKEN

post-admin-mfa-totp-challenge:
  handler: src/handlers/admin/mfa/post-admin-mfa-totp-challenge.handler
  timeout: 30
  events:
    - http:
        path: /admin/mfa/totp-challenge
        method: post
        cors: ${self:custom.cors}

post-admin-mfa-totp-disable:
  handler: src/handlers/admin/mfa/post-admin-mfa-totp-disable.handler
  timeout: 30
  events:
    - http:
        path: /admin/mfa/totp-disable
        method: post
        cors: ${self:custom.cors}
        authorizer:
          name: admin-authorizer
          type: TOKEN

post-admin-idp-code:
  handler: src/handlers/admin/idp/post-admin-idp-code.handler
  timeout: 30
  events:
    - http:
        path: /admin/idp/code
        method: post
        cors: ${self:custom.cors}

post-admin-idp-github-token:
  handler: src/handlers/admin/idp/github/post-admin-idp-github-token.handler
  timeout: 30
  events:
    - http:
        path: /admin/idp/github/token
        method: post
        cors: ${self:custom.cors}

get-admin-idp-github-user:
  handler: src/handlers/admin/idp/github/get-admin-idp-github-user.handler
  timeout: 30
  events:
    - http:
        path: /admin/idp/github/user
        method: get
        cors: ${self:custom.cors}
